{
    "swagger": "2.0",
    "info": {
        "description": "LIMS-Consumable Backend API",
        "title": "耗材管理系统 API",
        "contact": {},
        "version": "1.0"
    },
    "host": "localhost:8080",
    "basePath": "/",
    "paths": {
        "/api/v1/inventory": {
            "get": {
                "description": "综合查询库存状态，支持效期预警筛选",
                "tags": [
                    "Inventory"
                ],
                "summary": "库存总表查询",
                "parameters": [
                    {
                        "type": "integer",
                        "default": 1,
                        "description": "页码",
                        "name": "page",
                        "in": "query"
                    },
                    {
                        "type": "integer",
                        "default": 10,
                        "description": "每页数量",
                        "name": "page_size",
                        "in": "query"
                    },
                    {
                        "type": "string",
                        "description": "物料名称",
                        "name": "material_name",
                        "in": "query"
                    },
                    {
                        "type": "string",
                        "description": "物料编码",
                        "name": "code",
                        "in": "query"
                    },
                    {
                        "type": "string",
                        "description": "批号",
                        "name": "batch_no",
                        "in": "query"
                    },
                    {
                        "type": "integer",
                        "description": "状态: 0全部, 1正常, 2临期, 3过期",
                        "name": "status",
                        "in": "query"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "列表数据",
                        "schema": {
                            "$ref": "#/definitions/response.Response"
                        }
                    }
                }
            }
        },
        "/api/v1/inventory/import": {
            "post": {
                "consumes": [
                    "multipart/form-data"
                ],
                "produces": [
                    "application/json"
                ],
                "summary": "批量导入库存",
                "parameters": [
                    {
                        "type": "file",
                        "description": "Excel文件",
                        "name": "file",
                        "in": "formData",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "导入结果",
                        "schema": {
                            "allOf": [
                                {
                                    "$ref": "#/definitions/response.Response"
                                },
                                {
                                    "type": "object",
                                    "properties": {
                                        "data": {
                                            "$ref": "#/definitions/services.BatchImportResult"
                                        }
                                    }
                                }
                            ]
                        }
                    }
                }
            }
        },
        "/api/v1/inventory/inbound": {
            "post": {
                "description": "耗材批量入库接口，支持自动创建新物料或追加库存",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Inventory"
                ],
                "summary": "耗材入库",
                "parameters": [
                    {
                        "description": "入库信息",
                        "name": "request",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/services.InboundDTO"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "成功",
                        "schema": {
                            "$ref": "#/definitions/response.Response"
                        }
                    }
                }
            }
        },
        "/api/v1/inventory/recommend": {
            "get": {
                "description": "根据 FEFO (先失效先出) 策略推荐领用批次",
                "tags": [
                    "Inventory"
                ],
                "summary": "智能推荐批次 (FEFO)",
                "parameters": [
                    {
                        "type": "integer",
                        "description": "物料ID",
                        "name": "material_id",
                        "in": "query",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "推荐批次列表",
                        "schema": {
                            "$ref": "#/definitions/response.Response"
                        }
                    }
                }
            }
        },
        "/api/v1/inventory/{id}": {
            "delete": {
                "description": "删除指定库存(需管理员或库管员权限)",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Inventory"
                ],
                "summary": "删除库存",
                "parameters": [
                    {
                        "type": "integer",
                        "description": "库存ID",
                        "name": "id",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "成功",
                        "schema": {
                            "$ref": "#/definitions/response.Response"
                        }
                    }
                }
            }
        },
        "/api/v1/materials": {
            "get": {
                "description": "分页查询耗材基础信息，支持模糊搜索",
                "tags": [
                    "Material"
                ],
                "summary": "查询耗材列表",
                "parameters": [
                    {
                        "type": "integer",
                        "default": 1,
                        "description": "页码",
                        "name": "page",
                        "in": "query"
                    },
                    {
                        "type": "integer",
                        "default": 10,
                        "description": "每页数量",
                        "name": "page_size",
                        "in": "query"
                    },
                    {
                        "type": "string",
                        "description": "物料名称(模糊)",
                        "name": "name",
                        "in": "query"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "列表数据",
                        "schema": {
                            "$ref": "#/definitions/response.Response"
                        }
                    }
                }
            },
            "post": {
                "description": "录入新的耗材信息(需管理员或库管员权限)",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Material"
                ],
                "summary": "创建耗材基础信息",
                "parameters": [
                    {
                        "description": "耗材信息",
                        "name": "request",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/models.Material"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "成功",
                        "schema": {
                            "$ref": "#/definitions/response.Response"
                        }
                    }
                }
            }
        },
        "/api/v1/materials/{id}": {
            "delete": {
                "description": "删除指定耗材(需管理员或库管员权限)",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Material"
                ],
                "summary": "删除耗材",
                "parameters": [
                    {
                        "type": "integer",
                        "description": "耗材ID",
                        "name": "id",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "成功",
                        "schema": {
                            "$ref": "#/definitions/response.Response"
                        }
                    }
                }
            }
        },
        "/api/v1/outbound/apply": {
            "post": {
                "description": "提交领用申请，扣减库存并生成记录",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Outbound"
                ],
                "summary": "领用申请",
                "parameters": [
                    {
                        "description": "领用信息",
                        "name": "request",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/controllers.ApplyOutboundReq"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "成功",
                        "schema": {
                            "$ref": "#/definitions/response.Response"
                        }
                    }
                }
            }
        },
        "/api/v1/outbound/my": {
            "get": {
                "description": "查询当前登录用户的领用历史",
                "tags": [
                    "Outbound"
                ],
                "summary": "我的领用记录",
                "parameters": [
                    {
                        "type": "integer",
                        "default": 1,
                        "description": "页码",
                        "name": "page",
                        "in": "query"
                    },
                    {
                        "type": "integer",
                        "default": 10,
                        "description": "每页数量",
                        "name": "page_size",
                        "in": "query"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "列表数据",
                        "schema": {
                            "$ref": "#/definitions/response.Response"
                        }
                    }
                }
            }
        },
        "/api/v1/outbound/{id}/status": {
            "put": {
                "description": "更新领用记录的状态(如: USING -\u003e FINISHED)",
                "tags": [
                    "Outbound"
                ],
                "summary": "更新使用状态",
                "parameters": [
                    {
                        "type": "integer",
                        "description": "记录ID",
                        "name": "id",
                        "in": "path",
                        "required": true
                    },
                    {
                        "type": "string",
                        "description": "新状态 (USING/FINISHED)",
                        "name": "status",
                        "in": "query",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "成功",
                        "schema": {
                            "$ref": "#/definitions/response.Response"
                        }
                    }
                }
            }
        },
        "/auth/login": {
            "post": {
                "description": "用户通过账号密码登录，获取 JWT Token",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Auth"
                ],
                "summary": "用户登录",
                "parameters": [
                    {
                        "description": "登录参数",
                        "name": "request",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/controllers.LoginReq"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "登录成功",
                        "schema": {
                            "$ref": "#/definitions/response.Response"
                        }
                    },
                    "400": {
                        "description": "参数错误",
                        "schema": {
                            "$ref": "#/definitions/response.Response"
                        }
                    },
                    "401": {
                        "description": "认证失败",
                        "schema": {
                            "$ref": "#/definitions/response.Response"
                        }
                    }
                }
            }
        },
        "/auth/register": {
            "post": {
                "description": "开放注册接口，默认角色为 普通用户",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Auth"
                ],
                "summary": "用户注册",
                "parameters": [
                    {
                        "description": "注册参数",
                        "name": "request",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/controllers.RegisterReq"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "注册成功",
                        "schema": {
                            "$ref": "#/definitions/response.Response"
                        }
                    },
                    "400": {
                        "description": "参数错误",
                        "schema": {
                            "$ref": "#/definitions/response.Response"
                        }
                    },
                    "500": {
                        "description": "服务器错误",
                        "schema": {
                            "$ref": "#/definitions/response.Response"
                        }
                    }
                }
            }
        }
    },
    "definitions": {
        "controllers.ApplyOutboundReq": {
            "type": "object",
            "required": [
                "inventory_id",
                "purpose",
                "quantity"
            ],
            "properties": {
                "inventory_id": {
                    "description": "库存ID",
                    "type": "integer"
                },
                "purpose": {
                    "description": "领用用途",
                    "type": "string"
                },
                "quantity": {
                    "description": "领用数量(\u003e0)",
                    "type": "integer"
                }
            }
        },
        "controllers.LoginReq": {
            "type": "object",
            "required": [
                "password",
                "username"
            ],
            "properties": {
                "password": {
                    "description": "密码",
                    "type": "string"
                },
                "username": {
                    "description": "用户名",
                    "type": "string"
                }
            }
        },
        "controllers.RegisterReq": {
            "type": "object",
            "required": [
                "password",
                "username"
            ],
            "properties": {
                "password": {
                    "description": "密码",
                    "type": "string"
                },
                "real_name": {
                    "description": "真实姓名",
                    "type": "string"
                },
                "role": {
                    "description": "角色: 管理员, 操作员, 普通用户",
                    "type": "string"
                },
                "username": {
                    "description": "用户名",
                    "type": "string"
                }
            }
        },
        "models.Material": {
            "type": "object",
            "properties": {
                "brand": {
                    "description": "厂家/品牌",
                    "type": "string"
                },
                "category": {
                    "description": "物料类型(如: 试剂、耗材)",
                    "type": "string"
                },
                "code": {
                    "description": "物料编码(唯一标识)",
                    "type": "string"
                },
                "created_at": {
                    "description": "创建时间",
                    "type": "string"
                },
                "expiry_alert_days": {
                    "description": "有效期预警天数",
                    "type": "integer"
                },
                "id": {
                    "description": "主键ID",
                    "type": "integer"
                },
                "name": {
                    "description": "物料名称",
                    "type": "string"
                },
                "opened_expiry_days": {
                    "description": "开封后有效期(天)",
                    "type": "integer"
                },
                "safety_stock": {
                    "description": "安全库存",
                    "type": "integer"
                },
                "spec": {
                    "description": "规格型号",
                    "type": "string"
                },
                "unit": {
                    "description": "计量单位",
                    "type": "string"
                },
                "updated_at": {
                    "description": "更新时间",
                    "type": "string"
                }
            }
        },
        "response.Response": {
            "type": "object",
            "properties": {
                "code": {
                    "description": "Code 业务状态码\n200 表示成功，其他值表示具体的业务错误",
                    "type": "integer"
                },
                "data": {
                    "description": "Data 业务数据\n存放实际返回的业务数据对象或列表"
                },
                "errMsg": {
                    "description": "ErrMsg 错误详情\n仅在调试模式或特定异常时返回，用于排查问题\nomitempty 表示如果为空则不序列化该字段",
                    "type": "string"
                },
                "msg": {
                    "description": "Msg 友好提示信息\n用于前端展示给用户的消息",
                    "type": "string"
                },
                "timestamp": {
                    "description": "Timestamp 响应生成时间戳\n格式：ISO8601 (2006-01-02T15:04:05Z07:00)",
                    "type": "string"
                }
            }
        },
        "services.BatchImportResult": {
            "type": "object",
            "properties": {
                "errors": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "failed": {
                    "type": "integer"
                },
                "msg": {
                    "type": "string"
                },
                "success": {
                    "type": "integer"
                },
                "total": {
                    "type": "integer"
                }
            }
        },
        "services.InboundDTO": {
            "type": "object",
            "required": [
                "inboundNo"
            ],
            "properties": {
                "batchNo": {
                    "description": "内部批号",
                    "type": "string"
                },
                "brand": {
                    "description": "厂家/品牌",
                    "type": "string"
                },
                "category": {
                    "description": "物料类型",
                    "type": "string"
                },
                "currentQuantity": {
                    "description": "当前库存数量",
                    "type": "integer",
                    "format": "int64"
                },
                "expiryDate": {
                    "description": "有效期 (YYYY-MM-DD)",
                    "type": "string"
                },
                "inboundNo": {
                    "description": "入库单号",
                    "type": "string"
                },
                "materialCode": {
                    "description": "物料编码",
                    "type": "string"
                },
                "materialName": {
                    "description": "物料名称",
                    "type": "string"
                },
                "mode": {
                    "description": "模式: \"append\" 追加, \"overwrite\" 覆盖 (默认追加)",
                    "type": "string"
                },
                "quantity": {
                    "description": "数量 (初始入库数量)",
                    "type": "integer",
                    "format": "int64"
                },
                "spec": {
                    "description": "规格",
                    "type": "string"
                },
                "unit": {
                    "description": "单位",
                    "type": "string"
                }
            }
        }
    }
}